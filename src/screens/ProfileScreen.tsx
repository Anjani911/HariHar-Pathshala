import React, { useState } from 'react';
import {
  View,
  Text,
  TouchableOpacity,
  StyleSheet,
  ScrollView,
  Alert,
  TextInput,
  Dimensions,
} from 'react-native';

const { width } = Dimensions.get('window');

const ProfileScreen = () => {
  const [isEditing, setIsEditing] = useState(false);
  const [profileData, setProfileData] = useState({
    teacherName: 'рд╢реНрд░реА рд░рд╛рдо рдХреБрдорд╛рд░ рд╢рд░реНрдорд╛',
    phone: '9876543210',
    email: 'ram.sharma@education.cg.gov.in',
    schoolName: 'рд░рд╛рдЬрдХреАрдп рдкреНрд░рд╛рдердорд┐рдХ рд╢рд╛рд▓рд╛ рд░рд╛рдпрдкреБрд░',
    schoolCode: '22010100101',
    designation: 'рдкреНрд░рдзрд╛рди рдкрд╛рдардХ',
    experience: '15 рд╡рд░реНрд╖',
    joiningDate: '5 рдЬреБрд▓рд╛рдИ 2008',
    district: 'рд░рд╛рдпрдкреБрд░',
    block: 'рд░рд╛рдпрдкреБрд░ рдмреНрд▓реЙрдХ-1',
  });

  const [originalData, setOriginalData] = useState(profileData);

  const achievements = [
    {
      id: 1,
      title: 'рдЗрдХреЛ рдХреНрд▓рдм рд▓реАрдбрд░',
      description: 'рд╕реНрдХреВрд▓ рдореЗрдВ рд╕рдлрд▓ рдЗрдХреЛ рдХреНрд▓рдм рд╕рдВрдЪрд╛рд▓рди',
      date: '2024',
      icon: 'ЁЯМ▒',
    },
    {
      id: 2,
      title: '100% рдлреЛрдЯреЛ рдЕрдкрд▓реЛрдб',
      description: 'рд╕рднреА рдЫрд╛рддреНрд░реЛрдВ рдХреА рдлреЛрдЯреЛ рд╕рдордп рдкрд░ рдЕрдкрд▓реЛрдб',
      date: '2023',
      icon: 'ЁЯУ╕',
    },
    {
      id: 3,
      title: 'рдкрд░реНрдпрд╛рд╡рд░рдг рд╕рдВрд░рдХреНрд╖рдХ',
      description: 'рдкрд░реНрдпрд╛рд╡рд░рдг рд╕рдВрд░рдХреНрд╖рдг рдореЗрдВ рдпреЛрдЧрджрд╛рди',
      date: '2023',
      icon: 'ЁЯПЖ',
    },
  ];

  const appStats = {
    loginDays: 45,
    photosUploaded: 89,
    certificatesGenerated: 72,
    notificationsRead: 15,
  };

  const handleSaveProfile = () => {
    if (!profileData.teacherName || !profileData.phone) {
      Alert.alert('рддреНрд░реБрдЯрд┐', 'рдирд╛рдо рдФрд░ рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВ');
      return;
    }

    if (profileData.phone.length !== 10) {
      Alert.alert('рддреНрд░реБрдЯрд┐', 'рдХреГрдкрдпрд╛ рд╕рд╣реА рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ рдбрд╛рд▓реЗрдВ (10 рдЕрдВрдХ)');
      return;
    }

    Alert.alert(
      'рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╕реЗрд╡ рдХрд░реЗрдВ',
      'рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдкреНрд░реЛрдлрд╛рдЗрд▓ рдореЗрдВ рдмрджрд▓рд╛рд╡ рд╕реЗрд╡ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?',
      [
        {
          text: 'рд╣рд╛рдБ, рд╕реЗрд╡ рдХрд░реЗрдВ',
          onPress: () => {
            setOriginalData(profileData);
            setIsEditing(false);
            Alert.alert('рд╕рдлрд▓!', 'рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдЕрдкрдбреЗрдЯ рд╣реЛ рдЧрдИ');
          },
        },
        { text: 'рд░рджреНрдж рдХрд░реЗрдВ', style: 'cancel' },
      ]
    );
  };

  const handleCancelEdit = () => {
    setProfileData(originalData);
    setIsEditing(false);
  };

  const handleLogout = () => {
    Alert.alert(
      'рд▓реЙрдЧрдЖрдЙрдЯ',
      'рдХреНрдпрд╛ рдЖрдк рд╡рд╛рдХрдИ рд▓реЙрдЧрдЖрдЙрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?',
      [
        {
          text: 'рд╣рд╛рдБ, рд▓реЙрдЧрдЖрдЙрдЯ рдХрд░реЗрдВ',
          onPress: () => Alert.alert('рд▓реЙрдЧрдЖрдЙрдЯ', 'рдЖрдк рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЙрдЧрдЖрдЙрдЯ рд╣реЛ рдЧрдП рд╣реИрдВ'),
          style: 'destructive',
        },
        { text: 'рд░рджреНрдж рдХрд░реЗрдВ', style: 'cancel' },
      ]
    );
  };

  const handleChangePassword = () => {
    Alert.alert(
      'рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓реЗрдВ',
      'рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ рдкрд░ OTP рдорд┐рд▓реЗрдЧрд╛',
      [
        {
          text: 'OTP рднреЗрдЬреЗрдВ',
          onPress: () => Alert.alert('OTP рднреЗрдЬрд╛ рдЧрдпрд╛', 'рдЖрдкрдХреЗ рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ рдкрд░ OTP рднреЗрдЬ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ'),
        },
        { text: 'рд░рджреНрдж рдХрд░реЗрдВ', style: 'cancel' },
      ]
    );
  };

  const handleInputChange = (field: string, value: string) => {
    setProfileData(prev => ({
      ...prev,
      [field]: value,
    }));
  };

  return (
    <View style={styles.container}>
      <View style={styles.header}>
        <Text style={styles.headerTitle}>ЁЯСитАНЁЯПл рдкреНрд░реЛрдлрд╛рдЗрд▓</Text>
        <Text style={styles.headerSubtitle}>рдЖрдкрдХреА рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЬрд╛рдирдХрд╛рд░реА</Text>
      </View>

      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>
        {/* Profile Card */}
        <View style={styles.profileCard}>
          <View style={styles.profileHeader}>
            <View style={styles.avatarContainer}>
              <Text style={styles.avatarText}>ЁЯСитАНЁЯПл</Text>
            </View>
            <View style={styles.profileInfo}>
              <Text style={styles.profileName}>{profileData.teacherName}</Text>
              <Text style={styles.profileDesignation}>{profileData.designation}</Text>
              <Text style={styles.profileSchool}>{profileData.schoolName}</Text>
            </View>
            <TouchableOpacity 
              style={styles.editButton}
              onPress={() => setIsEditing(!isEditing)}
            >
              <Text style={styles.editButtonText}>
                {isEditing ? 'тЭМ' : 'тЬПя╕П'}
              </Text>
            </TouchableOpacity>
          </View>
        </View>

        {/* App Usage Stats */}
        <View style={styles.statsCard}>
          <Text style={styles.statsTitle}>ЁЯУК рдРрдк рдЙрдкрдпреЛрдЧ рдЖрдВрдХрдбрд╝реЗ</Text>
          <View style={styles.statsGrid}>
            <View style={styles.statItem}>
              <Text style={styles.statNumber}>{appStats.loginDays}</Text>
              <Text style={styles.statLabel}>рд▓реЙрдЧрд┐рди рджрд┐рди</Text>
            </View>
            <View style={styles.statItem}>
              <Text style={styles.statNumber}>{appStats.photosUploaded}</Text>
              <Text style={styles.statLabel}>рдлреЛрдЯреЛ рдЕрдкрд▓реЛрдб</Text>
            </View>
            <View style={styles.statItem}>
              <Text style={styles.statNumber}>{appStats.certificatesGenerated}</Text>
              <Text style={styles.statLabel}>рдкреНрд░рдорд╛рдгрдкрддреНрд░</Text>
            </View>
            <View style={styles.statItem}>
              <Text style={styles.statNumber}>{appStats.notificationsRead}</Text>
              <Text style={styles.statLabel}>рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди</Text>
            </View>
          </View>
        </View>

        {/* Personal Information */}
        <View style={styles.infoCard}>
          <Text style={styles.infoTitle}>ЁЯУЛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЬрд╛рдирдХрд╛рд░реА</Text>
          
          <View style={styles.infoGrid}>
            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдирд╛рдо</Text>
              {isEditing ? (
                <TextInput
                  style={styles.infoInput}
                  value={profileData.teacherName}
                  onChangeText={(value) => handleInputChange('teacherName', value)}
                />
              ) : (
                <Text style={styles.infoValue}>{profileData.teacherName}</Text>
              )}
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░</Text>
              {isEditing ? (
                <TextInput
                  style={styles.infoInput}
                  value={profileData.phone}
                  onChangeText={(value) => handleInputChange('phone', value)}
                  keyboardType="phone-pad"
                  maxLength={10}
                />
              ) : (
                <Text style={styles.infoValue}>{profileData.phone}</Text>
              )}
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдИрдореЗрд▓</Text>
              {isEditing ? (
                <TextInput
                  style={styles.infoInput}
                  value={profileData.email}
                  onChangeText={(value) => handleInputChange('email', value)}
                  keyboardType="email-address"
                  autoCapitalize="none"
                />
              ) : (
                <Text style={styles.infoValue}>{profileData.email}</Text>
              )}
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдкрджрдирд╛рдо</Text>
              <Text style={styles.infoValue}>{profileData.designation}</Text>
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдЕрдиреБрднрд╡</Text>
              <Text style={styles.infoValue}>{profileData.experience}</Text>
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдЬреНрд╡рд╛рдЗрдирд┐рдВрдЧ рддрд╛рд░реАрдЦ</Text>
              <Text style={styles.infoValue}>{profileData.joiningDate}</Text>
            </View>
          </View>

          {isEditing && (
            <View style={styles.editActions}>
              <TouchableOpacity style={styles.saveButton} onPress={handleSaveProfile}>
                <Text style={styles.saveButtonText}>тЬЕ рд╕реЗрд╡ рдХрд░реЗрдВ</Text>
              </TouchableOpacity>
              <TouchableOpacity style={styles.cancelButton} onPress={handleCancelEdit}>
                <Text style={styles.cancelButtonText}>тЭМ рд░рджреНрдж рдХрд░реЗрдВ</Text>
              </TouchableOpacity>
            </View>
          )}
        </View>

        {/* School Information */}
        <View style={styles.infoCard}>
          <Text style={styles.infoTitle}>ЁЯПл рд╕реНрдХреВрд▓ рдХреА рдЬрд╛рдирдХрд╛рд░реА</Text>
          
          <View style={styles.infoGrid}>
            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рд╕реНрдХреВрд▓ рдХрд╛ рдирд╛рдо</Text>
              <Text style={styles.infoValue}>{profileData.schoolName}</Text>
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рд╕реНрдХреВрд▓ рдХреЛрдб</Text>
              <Text style={styles.infoValue}>{profileData.schoolCode}</Text>
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдЬрд┐рд▓рд╛</Text>
              <Text style={styles.infoValue}>{profileData.district}</Text>
            </View>

            <View style={styles.infoItem}>
              <Text style={styles.infoLabel}>рдмреНрд▓реЙрдХ</Text>
              <Text style={styles.infoValue}>{profileData.block}</Text>
            </View>
          </View>
        </View>

        {/* Achievements */}
        <View style={styles.achievementsCard}>
          <Text style={styles.achievementsTitle}>ЁЯПЖ рдЙрдкрд▓рдмреНрдзрд┐рдпрд╛рдВ</Text>
          
          {achievements.map((achievement) => (
            <View key={achievement.id} style={styles.achievementItem}>
              <Text style={styles.achievementIcon}>{achievement.icon}</Text>
              <View style={styles.achievementInfo}>
                <Text style={styles.achievementTitle}>{achievement.title}</Text>
                <Text style={styles.achievementDescription}>{achievement.description}</Text>
                <Text style={styles.achievementDate}>{achievement.date}</Text>
              </View>
            </View>
          ))}
        </View>

        {/* Action Buttons */}
        <View style={styles.actionsCard}>
          <Text style={styles.actionsTitle}>тЪЩя╕П рдЦрд╛рддрд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕</Text>
          
          <TouchableOpacity style={styles.actionButton} onPress={handleChangePassword}>
            <Text style={styles.actionEmoji}>ЁЯФР</Text>
            <Text style={styles.actionText}>рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓реЗрдВ</Text>
            <Text style={styles.actionArrow}>тЖТ</Text>
          </TouchableOpacity>

          <TouchableOpacity 
            style={styles.actionButton}
            onPress={() => Alert.alert('рд╕рд╣рд╛рдпрддрд╛', 'рддрдХрдиреАрдХреА рд╕рд╣рд╛рдпрддрд╛ рдХреЗ рд▓рд┐рдП 1800-xxx-xxxx рдкрд░ рдХреЙрд▓ рдХрд░реЗрдВ')}
          >
            <Text style={styles.actionEmoji}>ЁЯУЮ</Text>
            <Text style={styles.actionText}>рд╕рд╣рд╛рдпрддрд╛ рдХреЗрдВрджреНрд░</Text>
            <Text style={styles.actionArrow}>тЖТ</Text>
          </TouchableOpacity>

          <TouchableOpacity 
            style={styles.actionButton}
            onPress={() => Alert.alert('рдлреАрдбрдмреИрдХ', 'рдХреГрдкрдпрд╛ рдЕрдкрдиреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ helpdesk@education.cg.gov.in рдкрд░ рднреЗрдЬреЗрдВ')}
          >
            <Text style={styles.actionEmoji}>ЁЯТм</Text>
            <Text style={styles.actionText}>рдлреАрдбрдмреИрдХ рджреЗрдВ</Text>
            <Text style={styles.actionArrow}>тЖТ</Text>
          </TouchableOpacity>

          <TouchableOpacity 
            style={styles.actionButton}
            onPress={() => Alert.alert('рдРрдк рд╡рд░реНрдЬрди', 'рдПрдХ рдкреЗрдбрд╝ рдорд╛рдБ рдХреЗ рдирд╛рдо 2.0\nрд╡рд░реНрдЬрди: 2.1.0\nрдмрд┐рд▓реНрдб: 2024.02.15')}
          >
            <Text style={styles.actionEmoji}>тД╣я╕П</Text>
            <Text style={styles.actionText}>рдРрдк рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</Text>
            <Text style={styles.actionArrow}>тЖТ</Text>
          </TouchableOpacity>
        </View>

        {/* Logout Button */}
        <TouchableOpacity style={styles.logoutButton} onPress={handleLogout}>
          <Text style={styles.logoutButtonText}>ЁЯЪк рд▓реЙрдЧрдЖрдЙрдЯ рдХрд░реЗрдВ</Text>
        </TouchableOpacity>

        {/* Footer */}
        <View style={styles.footer}>
          <Text style={styles.footerText}>
            рд░рд╛рдпрдкреБрд░ рдЬрд┐рд▓рд╛ рд╢рд┐рдХреНрд╖рд╛ рд╡рд┐рднрд╛рдЧ{'\n'}рдЫрддреНрддреАрд╕рдЧрдврд╝ рд╕рд░рдХрд╛рд░
          </Text>
        </View>
      </ScrollView>
    </View>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#E8F5E8',
  },
  header: {
    backgroundColor: '#2E7D32',
    paddingTop: 60,
    paddingBottom: 24,
    paddingHorizontal: 20,
    alignItems: 'center',
  },
  headerTitle: {
    fontSize: 24,
    fontWeight: 'bold',
    color: 'white',
    marginBottom: 4,
  },
  headerSubtitle: {
    fontSize: 16,
    color: 'white',
    opacity: 0.9,
  },
  content: {
    flex: 1,
    padding: 16,
  },
  profileCard: {
    backgroundColor: 'white',
    borderRadius: 16,
    padding: 20,
    marginBottom: 16,
    elevation: 3,
  },
  profileHeader: {
    flexDirection: 'row',
    alignItems: 'center',
  },
  avatarContainer: {
    width: 80,
    height: 80,
    borderRadius: 40,
    backgroundColor: '#E8F5E8',
    justifyContent: 'center',
    alignItems: 'center',
    marginRight: 16,
  },
  avatarText: {
    fontSize: 36,
  },
  profileInfo: {
    flex: 1,
  },
  profileName: {
    fontSize: 20,
    fontWeight: 'bold',
    color: '#2E7D32',
    marginBottom: 4,
  },
  profileDesignation: {
    fontSize: 16,
    color: '#4CAF50',
    marginBottom: 4,
  },
  profileSchool: {
    fontSize: 14,
    color: '#666',
  },
  editButton: {
    padding: 8,
  },
  editButtonText: {
    fontSize: 20,
  },
  statsCard: {
    backgroundColor: 'white',
    borderRadius: 16,
    padding: 20,
    marginBottom: 16,
    elevation: 3,
  },
  statsTitle: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#2E7D32',
    marginBottom: 16,
    textAlign: 'center',
  },
  statsGrid: {
    flexDirection: 'row',
    justifyContent: 'space-between',
  },
  statItem: {
    alignItems: 'center',
    flex: 1,
  },
  statNumber: {
    fontSize: 24,
    fontWeight: 'bold',
    color: '#2E7D32',
    marginBottom: 4,
  },
  statLabel: {
    fontSize: 12,
    color: '#4CAF50',
    textAlign: 'center',
  },
  infoCard: {
    backgroundColor: 'white',
    borderRadius: 16,
    padding: 20,
    marginBottom: 16,
    elevation: 3,
  },
  infoTitle: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#2E7D32',
    marginBottom: 16,
  },
  infoGrid: {
    gap: 16,
  },
  infoItem: {
    borderBottomWidth: 1,
    borderBottomColor: '#F0F0F0',
    paddingBottom: 12,
  },
  infoLabel: {
    fontSize: 14,
    color: '#666',
    marginBottom: 4,
  },
  infoValue: {
    fontSize: 16,
    color: '#2E7D32',
    fontWeight: '500',
  },
  infoInput: {
    fontSize: 16,
    color: '#2E7D32',
    fontWeight: '500',
    borderWidth: 1,
    borderColor: '#C8E6C9',
    borderRadius: 8,
    padding: 8,
    backgroundColor: '#F8F8F8',
  },
  editActions: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    marginTop: 20,
  },
  saveButton: {
    backgroundColor: '#4CAF50',
    paddingHorizontal: 24,
    paddingVertical: 12,
    borderRadius: 8,
    flex: 1,
    marginRight: 8,
    alignItems: 'center',
  },
  saveButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: 'bold',
  },
  cancelButton: {
    backgroundColor: '#F44336',
    paddingHorizontal: 24,
    paddingVertical: 12,
    borderRadius: 8,
    flex: 1,
    marginLeft: 8,
    alignItems: 'center',
  },
  cancelButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: 'bold',
  },
  achievementsCard: {
    backgroundColor: 'white',
    borderRadius: 16,
    padding: 20,
    marginBottom: 16,
    elevation: 3,
  },
  achievementsTitle: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#2E7D32',
    marginBottom: 16,
  },
  achievementItem: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingVertical: 12,
    borderBottomWidth: 1,
    borderBottomColor: '#F0F0F0',
  },
  achievementIcon: {
    fontSize: 32,
    marginRight: 16,
  },
  achievementInfo: {
    flex: 1,
  },
  achievementTitle: {
    fontSize: 16,
    fontWeight: 'bold',
    color: '#2E7D32',
    marginBottom: 4,
  },
  achievementDescription: {
    fontSize: 14,
    color: '#4CAF50',
    marginBottom: 4,
  },
  achievementDate: {
    fontSize: 12,
    color: '#666',
  },
  actionsCard: {
    backgroundColor: 'white',
    borderRadius: 16,
    padding: 20,
    marginBottom: 16,
    elevation: 3,
  },
  actionsTitle: {
    fontSize: 18,
    fontWeight: 'bold',
    color: '#2E7D32',
    marginBottom: 16,
  },
  actionButton: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingVertical: 16,
    borderBottomWidth: 1,
    borderBottomColor: '#F0F0F0',
  },
  actionEmoji: {
    fontSize: 24,
    marginRight: 16,
  },
  actionText: {
    flex: 1,
    fontSize: 16,
    color: '#2E7D32',
  },
  actionArrow: {
    fontSize: 18,
    color: '#4CAF50',
  },
  logoutButton: {
    backgroundColor: '#F44336',
    padding: 16,
    borderRadius: 12,
    alignItems: 'center',
    marginBottom: 20,
    elevation: 3,
  },
  logoutButtonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: 'bold',
  },
  footer: {
    alignItems: 'center',
    marginBottom: 20,
  },
  footerText: {
    fontSize: 12,
    color: '#4CAF50',
    textAlign: 'center',
    lineHeight: 18,
  },
});

export default ProfileScreen;
